<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Pooulation pyramid</title>
        
        <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/systemjs/0.19.31/system.js"></script>       
        <script src="//cdn.rawgit.com/rdf2h/rdf2h/v0.3.0/dist/rdf-ext.js"></script>
        <script src="//cdn.rawgit.com/rdf2h/rdf2h/v0.3.0/dist/rdf2h.js"></script>
        <script src="//cdn.rawgit.com/retog/rdf-parser-n3-browser/v0.3.0b/dist/n3-parser.js"></script>
        <script src="//code.jquery.com/jquery-2.1.4.min.js"></script>
        <script src="//cdn.rawgit.com/rdf2h/ld2h/v0.4.1/dist/ld2h.js"></script>      
        <link rel="matchers" href="//cdn.rawgit.com/rdf2h/rdf2h.github.io/v0.0.1/2015/rdf2h-points.ttl" type="text/turtle"/>
        <link rel="matchers" href="https://cdn.rawgit.com/zazukoians/trifid-ld/v0.1.1/data/public/rdf2h/matchers.ttl" type="text/turtle" />
        <link rel="matchers" href="municipality-browser-matchers.ttl" type="text/turtle" />
        <link rel="matchers" href="agepyramid-matchers.ttl" type="text/turtle" />
        <link rel="stylesheet" href="agepyramid.css" />
 <script type="text/javascript">
            
            $(function () {
                
                    LD2h.expand().then(function() {
                        console.log("all done");
                    });
            });
        </script>
    </head>
    <body>
        <h2>Age pyramid</h2>
        <p>Right now hard coded to a municipality</p>
        <div resource="http://classifications.data.admin.ch/municipality/1"
             graph="http://lindas-data.ch/sparql?default-graph-uri=&query=PREFIX+gont%3A+%3chttps%3A%2F%2Fgont.ch%2F%3e%0D%0A%0D%0ACONSTRUCT+%7B%0D%0A++%3chttp%3A%2F%2Fclassifications.data.admin.ch%2Fmunicipality%2F1%3e+gont%3ApopulationSegment+[%0D%0A++++gont%3AfromAge+%3FfromAge+%3B%0D%0A++++gont%3AtoAge+%3FtoAge+%3B%0D%0A++++gont%3AmalePopulation+%3FMale_Inhabitants+%3B%0D%0A++++gont%3AfemalePopulation+%3FFemale_Inhabitants+%0D%0A++]%0D%0A%7D%0D%0A%0D%0AWHERE%0D%0A%7B%0D%0A++%7B%0D%0A++++SELECT+%0D%0A++++++(%3Fageinterval+AS+%3FfromAge)%0D%0A++++++(%3Fageinterval%2B4+AS+%3FtoAge)%0D%0A++++++(SUM(IF(%3Fsex%3D%3chttp%3A%2F%2Fdata.admin.ch%2Fbfs%2Fcode%2F1.0%2FCL_SEX%2F2%3e%2C%3Fnumber%2C0))+AS+%3FFemale_Inhabitants)%0D%0A++++++(SUM(IF(%3Fsex%3D%3chttp%3A%2F%2Fdata.admin.ch%2Fbfs%2Fcode%2F1.0%2FCL_SEX%2F1%3e%2C%3Fnumber%2C0))+AS+%3FMale_Inhabitants)%0D%0A++++WHERE%0D%0A++++%7B%0D%0A++++++++%3Fs+%3chttp%3A%2F%2Fdata.admin.ch%2Fbfs%2Fproperty%2FNB_PERSON%3e+%3Fnumber%3B%0D%0A++++++++%3chttp%3A%2F%2Fdata.admin.ch%2Fbfs%2Fproperty%2FPOPULATIONTYPE%3e+%3Fptype%3B%0D%0A++++++++%3chttp%3A%2F%2Fdata.admin.ch%2Fbfs%2Fproperty%2FSEX%3e+%3Fsex%3B%0D%0A++++++++%3chttp%3A%2F%2Fdata.admin.ch%2Fbfs%2Fproperty%2FREPORTINGMUNICIPALITYID%3e+%3Fremuniuri%3B%0D%0A++++++++%3chttp%3A%2F%2Fdata.admin.ch%2Fbfs%2Fproperty%2FAGE%3e+%3Fage.%0D%0A%0D%0A++++++++%3Fremuniuri+%3chttp%3A%2F%2Fwww.w3.org%2F2004%2F02%2Fskos%2Fcore%23notation%3e+%221%22.%0D%0A++++++++%3Fage+%3chttp%3A%2F%2Fwww.w3.org%2F2004%2F02%2Fskos%2Fcore%23notation%3e+%3Fagenumber.%0D%0A%0D%0A++++++++%3Fptype+%3chttp%3A%2F%2Fwww.w3.org%2F2004%2F02%2Fskos%2Fcore%23notation%3e+%3Fpnumber.%0D%0A++++++++FILTER+((xsd%3Aint(%3Fpnumber))+%3c%3D+2)%0D%0A%0D%0A++++++%7D%0D%0A++++++GROUP+BY+((FLOOR((xsd%3Aint(%3Fagenumber))%2F5)*5)+AS+%3Fageinterval)%0D%0A++++++ORDER+BY+DESC(xsd%3Aint(%3Fageinterval))%0D%0A++%7D%0D%0A%7D"
                class="fetch">
                Age pyramid should appear here
        </div>
        
        
<script>


</script>
    </body>
</html>
